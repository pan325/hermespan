<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è†è½²åˆºç§¦å¤§æ¢ç§˜</title>
    <!-- Open Graph å¡ç‰‡ä¿¡æ¯ -->
    <meta property="og:title" content="è†è½²åˆºç§¦å¤§æ¢ç§˜">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://pan325.github.io/hermespan/">
    <meta property="og:image" content="https://pan325.github.io/hermespan/cike.jpg">
    <meta property="og:description" content="æ²‰æµ¸å¼æˆ˜å›½äº’åŠ¨å‰§æƒ…ï¼Œä¸€åˆ†é’Ÿä½“éªŒè†è½²çš„ç”Ÿæ­»ä¸€åˆ»ï¼"><style>
        /* åŸºç¡€é‡ç½®ï¼šè§£å†³ç‚¹å‡»å’Œå°ºå¯¸é—®é¢˜ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            touch-action: manipulation; /* è§£å†³æ‰‹æœºç‚¹å‡»å»¶è¿Ÿ */
        }
        body {
            padding: 10px;
            font-family: "SimSun", serif;
            background-image: url("bg.jpg"); /* æœ¬åœ°èƒŒæ™¯å›¾ç‰‡ */
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            min-height: 100vh;
            color: #f8f4ea;
            line-height: 1.5;
            overflow-x: hidden; /* é˜²æ­¢æ¨ªå‘æ»šåŠ¨æ¡ */
        }
        /* è®¡æ—¶å™¨ç½®é¡¶ä¼˜åŒ–ï¼šå›ºå®šå®šä½åœ¨é¡¶éƒ¨ï¼Œå§‹ç»ˆå¯è§ */
        .timer {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1000;
            text-align: center;
            font-size: 16px;
            font-weight: bold;
            color: #9e2a2b;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 4px 12px;
            border-radius: 20px;
        }
        /* å®¹å™¨ï¼šç¡®ä¿å†…å®¹å±…ä¸­ */
        .main-container {
            width: 100%;
            margin: 0 auto;
            padding: 10px 5px;
            background-color: rgba(40, 20, 15, 0.9);
            border-radius: 8px;
            border: 1px solid #c9a87a;
            margin-bottom: 20px;
            margin-top: 50px; /* ä¸ºè®¡æ—¶å™¨ç•™å‡ºç©ºé—´ */
        }
        /* ä¸¤æ å¸ƒå±€ï¼šå§‹ç»ˆå·¦å³å¹¶åˆ— */
        .columns-wrap {
            display: flex;
            gap: 8px; /* å‡å°é—´è· */
            width: 100%;
            padding: 5px;
        }
        .column {
            flex: 1; /* ä¸¤æ å¹³å‡åˆ†é…å®½åº¦ */
            display: flex;
            flex-direction: column;
            gap: 10px;
            transition: all 0.5s ease; /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
        }
        /* æ ‡é¢˜ï¼šç²¾ç®€å°ºå¯¸ */
        .column-title {
            text-align: center;
            font-size: 14px;
            color: #f8d7a4;
            margin-bottom: 5px;
            padding-bottom: 3px;
            border-bottom: 1px solid #9e2a2b;
            font-weight: bold;
        }
        /* å·¦æ å¡ç‰‡ï¼šé€‚åº”æ‰‹æœºç«–å± */
        .word-card {
            width: 100%;
            min-height: 220px; /* å¤§å¹…é™ä½é«˜åº¦ */
            padding: 8px;
            border-radius: 5px;
            font-size: 13px; /* å‡å°å­—ä½“ */
            line-height: 1.5;
            text-align: justify;
            cursor: pointer;
            user-select: none;
            border: 1px solid #c9a87a;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            background-color: rgba(60, 30, 20, 0.9);
            color: #f8f4ea;
            overflow: hidden; /* é˜²æ­¢å†…å®¹æº¢å‡º */
            transition: all 0.5s ease; /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
        }
        /* å›ç›®æ ·å¼ */
        .chapter-num {
            display: inline-block;
            background-color: #9e2a2b;
            color: white;
            padding: 1px 5px;
            margin-right: 3px;
            margin-bottom: 3px;
            border-radius: 2px;
            font-size: 12px;
        }
        /* å³æ å¡ç‰‡ï¼šé€‚åº”æ‰‹æœºç«–å± */
        .meaning-card {
            width: 100%;
            min-height: 220px; /* ä¸å·¦æ ä¿æŒä¸€è‡´ */
            padding: 8px;
            padding-bottom: 30px;
            border-radius: 5px;
            font-size: 13px;
            font-weight: bold;
            color: #f8d7a4;
            text-align: center;
            cursor: pointer;
            user-select: none;
            border: 1px solid #c9a87a;
            position: relative;
            background-color: rgba(60, 30, 20, 0.9);
            background-size: contain;
            background-position: center;
            background-repeat: no-repeat;
            transition: all 0.5s ease; /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
        }
        /* å³æ æ–‡å­—ï¼šå›ºå®šåœ¨åº•éƒ¨ */
        .meaning-card span {
            position: absolute;
            bottom: 5px;
            left: 0;
            width: 100%;
            padding: 5px;
            background-color: rgba(40, 20, 15, 0.9);
            border-radius: 3px;
            border: 1px solid #c9a87a;
            font-size: 13px;
        }
        /* å›¾ç‰‡åŠ è½½å¤±è´¥æç¤º */
        .meaning-card.no-image::before {
            content: 'ğŸ“·';
            font-size: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #9e2a2b;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #604030;
        }
        /* é€‰ä¸­çŠ¶æ€ */
        .selected {
            border: 2px solid #9e2a2b;
            box-shadow: 0 2px 5px rgba(158, 42, 43, 0.5);
            transform: scale(1.01);
        }
        /* æ¶ˆå¤±åŠ¨ç”» - æ”¹è¿›ç‰ˆ */
        .fade-out {
            opacity: 0;
            height: 0 !important; /* å¼ºåˆ¶é«˜åº¦ä¸º0 */
            min-height: 0 !important; /* è¦†ç›–min-height */
            margin: 0 !important;
            padding: 0 !important;
            overflow: hidden;
            border: none;
            transition: all 0.5s ease;
        }
        /* éŸ³ä¹æ§åˆ¶æŒ‰é’® */
        .music-control {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: rgba(255, 249, 235, 0.95);
            border: 1px solid #c9a87a;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1000;
            font-size: 18px;
            color: #9e2a2b;
        }
        /* æ¸¸æˆå¼€å§‹é¡µé¢æ ·å¼ */
        .start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(40, 20, 15, 0.95);
            z-index: 2000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 15px;
            text-align: center;
        }
        .historical-intro {
            font-size: 16px;
            color: #f8d7a4;
            margin-bottom: 15px;
            line-height: 1.6;
            font-style: italic;
        }
        .start-title {
            font-size: 24px;
            color: #f8d7a4;
            margin-bottom: 20px;
            font-weight: bold;
        }
        .start-desc {
            font-size: 14px;
            color: #f8f4ea;
            line-height: 1.6;
            margin-bottom: 25px;
            max-width: 90%;
        }
        .start-btn {
            padding: 10px 25px;
            font-size: 16px;
            background-color: #9e2a2b;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }
        /* åŒ¹é…æˆåŠŸå¼¹çª—æ ·å¼ */
        .success-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            z-index: 2000;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }
        .success-img {
            width: 150px;
            height: 150px;
            border-radius: 8px;
            margin-bottom: 15px;
            object-fit: cover;
            border: 2px solid #f8f4ea;
        }
        .success-text {
            font-size: 18px;
            color: white;
            text-align: center;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        .poem {
            font-size: 14px;
            color: #f8d7a4;
            text-align: center;
            margin-bottom: 20px;
            line-height: 1.6;
            font-style: italic;
        }
        .restart-btn {
            padding: 8px 20px;
            font-size: 14px;
            background-color: #9e2a2b;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        /* éŸ³ä¹çŠ¶æ€æç¤º */
        .music-hint {
            position: fixed;
            top: 55px;
            right: 10px;
            background-color: rgba(255, 249, 235, 0.9);
            border: 1px solid #c9a87a;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 11px;
            color: #9e2a2b;
            z-index: 1000;
            display: none;
        }
        /* é”™è¯¯æç¤ºæ ·å¼ - ç¡®ä¿åœ¨æ‰‹æœºä¸Šå¯è§ */
        .error-toast {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(158, 42, 43, 0.9);
            color: white;
            padding: 12px 20px;
            border-radius: 6px;
            font-size: 16px;
            z-index: 3000;
            display: none;
            animation: fadeInOut 1.5s ease;
        }
        @keyframes fadeInOut {
            0% { opacity: 0; }
            20% { opacity: 1; }
            80% { opacity: 1; }
            100% { opacity: 0; }
        }

        /* é’ˆå¯¹å°å±æ‰‹æœºçš„é¢å¤–ä¼˜åŒ– */
        @media (max-width: 360px) {
            .word-card, .meaning-card {
                min-height: 200px;
                font-size: 12px;
            }
            .column-title {
                font-size: 13px;
            }
            .start-title {
                font-size: 22px;
            }
            .error-toast {
                font-size: 14px;
                padding: 10px 16px;
            }
        }
    </style>
</head>
<body>
    <!-- ç½®é¡¶è®¡æ—¶å™¨ -->
    <div class="timer" id="timer">00:00</div>
    
    <!-- éŸ³ä¹æ§åˆ¶æŒ‰é’® -->
    <div class="music-control" id="musicControl">â–¶</div>
    <div class="music-hint" id="musicHint">ç‚¹å‡»æ’­æ”¾éŸ³ä¹</div>
    
    <!-- é”™è¯¯æç¤ºç»„ä»¶ -->
    <div class="error-toast" id="errorToast">çŒœé”™å•¦ï¼Œå†è¯•è¯•ï¼</div>
    
    <!-- æ¸¸æˆå¼€å§‹é¡µé¢ï¼ˆé»˜è®¤æ˜¾ç¤ºï¼‰ -->
    <div class="start-screen" id="startScreen">
        <h2 class="start-title">è†è½²åˆºç§¦å¤§æ¢ç§˜</h2>
        <div class="historical-intro">
            ç§¦ç‹æ”¿äºŒåå¹´ï¼ˆå…¬å…ƒå‰227å¹´ï¼‰<br>
            å’¸é˜³å®«åˆºæ€ç°åœº<br>
            è†è½²ä¸ºä½•åŠŸè´¥å‚æˆï¼Ÿ
        </div>
        <p class="start-desc">
            æ¸¸æˆè§„åˆ™ï¼š<br>
            å·¦æ æ˜¯åˆºç§¦ä¸ƒä¸ªå…³é”®æ—¶åˆ»<br>
            å³æ æ˜¯åˆºç§¦ä¸ƒä¸ªå…³é”®äººç‰©<br>
            ç‚¹å‡»å·¦å³æ å®Œæˆä¸ƒä¸ªåŒ¹é…<br>
            æ„Ÿå—è†è½²åˆºç§¦çš„è¡æ°”å›è‚ 
        </p>
        <button class="start-btn" id="startBtn">å¼€å§‹æ¢ç§˜</button>
    </div>
    
    <!-- åŒ¹é…æˆåŠŸå¼¹çª—ï¼ˆé»˜è®¤éšè—ï¼‰ -->
    <div class="success-modal" id="successModal">
        <img src="hero.jpg" alt="è‹±é›„è†è½²å½¢è±¡" class="success-img" id="successImage">
        <div class="success-text" id="successText">æ­å–œï¼ä½ å·²è¿˜åŸåˆºç§¦äº‹ä»¶å…¨è²Œï¼æ€»ç”¨æ—¶ï¼š00:00</div>
        <div class="poem">
            ç‡•ä¸¹å–„å…»å£«ï¼Œå¿—åœ¨æŠ¥å¼ºå¬´ã€‚<br>
            æ‹›é›†ç™¾å¤«è‰¯ï¼Œå²æš®å¾—è†å¿ã€‚<br>
            æƒœå“‰å‰‘æœ¯ç–ï¼Œå¥‡åŠŸé‚ä¸æˆã€‚<br>
            å…¶äººè™½å·²æ²¡ï¼Œåƒè½½æœ‰ä½™æƒ…ã€‚
        </div>
        <button class="restart-btn" id="restartBtn">é‡æ–°æ¢ç§˜</button>
    </div>
    
    <!-- æ¸¸æˆä¸»å®¹å™¨ï¼ˆé»˜è®¤éšè—ï¼Œå¼€å§‹åæ˜¾ç¤ºï¼‰ -->
    <div class="main-container" id="gameContainer" style="display: none;">
        <div class="columns-wrap">
            <!-- å·¦æ ï¼šè†è½²åˆºç§¦ç« èŠ‚ï¼ˆæŒ‰é¡ºåºï¼‰ -->
            <div class="column" id="wordColumn">
                <h3 class="column-title">è†è½²åˆºç§¦Â·ç« èŠ‚</h3>
                <!-- åŠ¨æ€å†…å®¹å°†åœ¨è¿™é‡Œç”Ÿæˆ -->
            </div>
            <!-- å³æ ï¼šå†å²äººç‰©ï¼ˆéšæœºï¼‰ -->
            <div class="column" id="meaningColumn">
                <h3 class="column-title">å¯¹åº”å†å²äººç‰©</h3>
                <!-- åŠ¨æ€å†…å®¹å°†åœ¨è¿™é‡Œç”Ÿæˆ -->
            </div>
        </div>
    </div>

    <!-- èƒŒæ™¯éŸ³ä¹å…ƒç´  -->
    <audio id="backgroundMusic" loop preload="auto" style="display:none">
        <source src="music.mp3" type="audio/mpeg">
        <source src="å¤é£æ‚¬ç–‘éŸ³ä¹.mp3" type="audio/mpeg">
        <source src="https://assets.mixkit.co/music/preview/mixkit-suspense-ambient-585.mp3" type="audio/mpeg">
    </audio>

<script>
document.addEventListener('DOMContentLoaded', function () {
    /* ================= å…¨å±€å˜é‡ ================= */
    let selectedWordId = null;
    let matchedPairs   = 0;
    let startTime      = null;
    let timerInterval  = null;
    let isMusicPlaying = false;

    /* ================= DOMè·å– ================= */
    const timerEl         = document.getElementById('timer');
    const musicControl    = document.getElementById('musicControl');
    const musicHint       = document.getElementById('musicHint');
    const backgroundMusic = document.getElementById('backgroundMusic');
    const startScreen     = document.getElementById('startScreen');
    const startBtn        = document.getElementById('startBtn');
    const gameContainer   = document.getElementById('gameContainer');
    const successModal    = document.getElementById('successModal');
    const successText     = document.getElementById('successText');
    const restartBtn      = document.getElementById('restartBtn');
    const wordColumn      = document.getElementById('wordColumn');
    const meaningColumn   = document.getElementById('meaningColumn');
    const errorToast      = document.getElementById('errorToast'); // é”™è¯¯æç¤ºå…ƒç´ 

    /* ================= æ•°æ® & å·¥å…·å‡½æ•° ================= */
    const characters = [
        { id: "1", chapter: "ç¬¬ä¸€å›", text: "é‚£ä¸ªç”·äººå¯¹ç§¦ç‹å¬´æ”¿æ€€æœ‰æ·±ä»‡å¤§æ¨ã€‚ä»–é€ƒå›ç‡•å›½ï¼Œèª“è¦é›ªè€»ï¼Œæ‹›äººåˆºç§¦ï¼Œæœ€å¸Œæœ›åŠ«æŒç§¦ç‹å½’è¿˜å¤±åœ°ï¼Œå¦åˆ™æ ¼æ€å‹¿è®ºã€‚ä»–æ˜¯è°ï¼Ÿ", meaningId: "1", meaningText: "ç‡•å¤ªå­ä¸¹", image: "dan.jpg" },
        { id: "2", chapter: "ç¬¬äºŒå›", text: "è†è½²æ¥ä¸‹åˆºç§¦ä»¤ï¼Œå´ç¼ºå°‘ä¸¤æ ·â€œé—¨ç¥¨â€ï¼šç§¦ç‹ä»‡äººçš„å¤´ä¸ç‡•å›½åœ°å›¾ã€‚é‚£ä¸ªç”·äººä¸€å¬â€œå€Ÿå¤´â€ï¼ŒäºŒè¯ä¸è¯´ï¼Œæ‹”å‰‘è‡ªåˆã€‚ä»–æ˜¯è°ï¼Ÿ", meaningId: "2", meaningText: "ç§¦å°†æ¨Šæ–¼æœŸ", image: "qi.jpg" },
        { id: "3", chapter: "ç¬¬ä¸‰å›", text: "è†è½²è¦æ‰¾ä¸ªå‰¯æ‰‹ï¼Œå¬è¯´é‚£ä¸ªç”·äººåä¸‰å²å°±æ€äººï¼Œå‹‡æ­¦éå¸¸ï¼Œå¤§è¡—ä¸Šæ²¡äººæ•¢ä¸ä»–å¯¹è§†ã€‚è†è½²æ”¶äº†ä»–ï¼Œåˆºç§¦æœ‰äº†åŒä¿é™©ã€‚ä»–æ˜¯è°ï¼Ÿ", meaningId: "3", meaningText: "å‰¯ä½¿ç§¦èˆé˜³", image: "yang.jpg" },
        { id: "4", chapter: "ç¬¬å››å›", text: "åˆšèµ°è¿‘å’¸é˜³å®«æ®¿ï¼Œå‰¯æ‰‹çªç„¶è„¸ç™½å¦‚çº¸ï¼ŒåŒè…¿æŠ–åˆ°ä½©å‰‘å®å½“ã€‚é‚£ä¸ªç”·äººåªå¾—å¸¦ç€å…¨ç‡•å›½ä¹ƒè‡³å…¨å¤©ä¸‹çš„å¸Œæœ›ï¼Œå­¤èº«ä¸Šæ®¿ã€‚ä»–æ˜¯è°ï¼Ÿ", meaningId: "4", meaningText: "åˆºå®¢è†è½²", image: "cike.jpg" },
        { id: "5", chapter: "ç¬¬äº”å›", text: "åœ°å›¾å±•åˆ°å°½å¤´ï¼Œå¯’å…‰ä¸€é—ªï¼ŒåŒ•é¦–å‡ºç°ï¼Œé‚£ä¸ªç”·äººå†·æ±—ç›´æµã€‚ä»–è¢«è†è½²å·¦æ‰‹æŠ“è¢–ï¼Œå³æ‰‹ç›´åˆºï¼Œè¡£è¢–æ’•è£‚ï¼Œç«Ÿä¾¥å¹¸è„±èº«ã€‚ä»–æ˜¯è°ï¼Ÿ", meaningId: "5", meaningText: "ç§¦ç‹å¬´æ”¿", image: "zheng.jpg" },
        { id: "6", chapter: "ç¬¬å…­å›", text: "ç§¦ç‹é•¿å‰‘å¡åœ¨é˜å†…ï¼Œè¶Šæ€¥è¶Šæ‹”ä¸å‡ºï¼Œç¾¤è‡£æ‰‹ä¸Šä¹Ÿæ— å…µå™¨ï¼Œé‚£ä¸ªç”·äººçªç„¶æ·å‡ºè¯å›Šï¼Œæ­£ä¸­è†è½²ï¼Œåˆ¹é‚£é—´æ‹–å‡ºä¸€çº¿ç”Ÿæœºã€‚ä»–æ˜¯è°ï¼Ÿ", meaningId: "6", meaningText: "ä¾åŒ»å¤æ— ä¸”", image: "ju.jpg" },
        { id: "7", chapter: "ç¬¬ä¸ƒå›", text: "ç§¦ç‹åœ¨èƒŒä¸Šæ‹”å‡ºå®å‰‘ï¼Œæ–©æ–­è†è½²å·¦è…¿ï¼Œé‚£ä¸ªç”·äººå€šæŸ±å¤§ç¬‘ï¼Œå°†åŒ•é¦–æœ€åä¸€æ·ï¼Œå¯æƒœä¸ä¸­ï¼Œåè¢«æ–©æ€ï¼Œè¡€æº…å’¸é˜³å®«ä¸­ã€‚ä»–æ˜¯è°ï¼Ÿ", meaningId: "7", meaningText: "è‹±é›„è†è½²", image: "hero.jpg" }
    ];
    
    function shuffleArray(array) { 
        const newArr = [...array]; 
        for (let i = newArr.length - 1; i > 0; i--) { 
            const j = Math.floor(Math.random() * (i + 1)); 
            [newArr[i], newArr[j]] = [newArr[j], newArr[i]]; 
        } 
        return newArr; 
    }
    
    function renderGameCards() { 
        // æ¸…ç©ºä¹‹å‰çš„å†…å®¹
        wordColumn.innerHTML = '<h3 class="column-title">è†è½²åˆºç§¦Â·ç« èŠ‚</h3>';
        meaningColumn.innerHTML = '<h3 class="column-title">å¯¹åº”å†å²äººç‰©</h3>';
        
        // å·¦æ æŒ‰åŸå§‹é¡ºåºæ’åˆ—ï¼ˆç¬¬ä¸€å›åˆ°ç¬¬ä¸ƒå›ï¼‰
        characters.forEach(character => {
            const card = document.createElement('div');
            card.className = `word-card`;
            card.setAttribute('data-id', character.id);
            card.innerHTML = `<span class="chapter-num">${character.chapter}</span>${character.text}`;
            wordColumn.appendChild(card);
        });

        // å³æ éšæœºæ’åº
        const shuffledMeanings = shuffleArray(characters);
        shuffledMeanings.forEach(character => {
            const card = document.createElement('div');
            card.className = `meaning-card`;
            card.setAttribute('data-meaning-id', character.meaningId);
            card.innerHTML = `<span>${character.meaningText}</span>`;
            
            // è®¾ç½®æœ¬åœ°å›¾ç‰‡èƒŒæ™¯
            const imgUrl = `url('${character.image}')`;
            const style = document.createElement('style');
            style.textContent = `
                .meaning-card[data-meaning-id="${character.meaningId}"] {
                    background-image: ${imgUrl};
                }
            `;
            document.head.appendChild(style);
            
            // ç›‘å¬å›¾ç‰‡åŠ è½½å¤±è´¥äº‹ä»¶
            const img = new Image();
            img.src = character.image;
            img.onerror = function() {
                card.classList.add('no-image');
            };
            
            meaningColumn.appendChild(card);
        });

        // ç»‘å®šå¡ç‰‡ç‚¹å‡»äº‹ä»¶
        bindCardEvents();
    }
    
    // æ˜¾ç¤ºé”™è¯¯æç¤º
    function showErrorToast() {
        errorToast.style.display = 'block';
        // 1.5ç§’åéšè—æç¤º
        setTimeout(() => {
            errorToast.style.display = 'none';
        }, 1500);
    }
    
    // ç»‘å®šå¡ç‰‡ç‚¹å‡»äº‹ä»¶
    function bindCardEvents() {
        // å·¦æ å¡ç‰‡ç‚¹å‡»äº‹ä»¶
        const wordCards = document.querySelectorAll('.word-card');
        wordCards.forEach(card => {
            card.addEventListener('click', function() {
                // ç‚¹å‡»å¡ç‰‡æ—¶å°è¯•æ’­æ”¾éŸ³ä¹
                if (!isMusicPlaying) {
                    backgroundMusic.play().then(() => {
                        isMusicPlaying = true;
                        musicControl.textContent = "â¸";
                        musicHint.style.display = 'none';
                    }).catch(e => console.log("æ’­æ”¾å¤±è´¥:", e));
                }
                
                wordCards.forEach(c => c.classList.remove('selected'));
                this.classList.add('selected');
                selectedWordId = this.getAttribute('data-id');
            });
        });

        // å³æ å¡ç‰‡ç‚¹å‡»äº‹ä»¶
        const meaningCards = document.querySelectorAll('.meaning-card');
        meaningCards.forEach(card => {
            card.addEventListener('click', function() {
                if (!selectedWordId) return;
                
                const correctMeaningId = characters.find(c => c.id === selectedWordId).meaningId;
                const cardMeaningId = this.getAttribute('data-meaning-id');
                
                if (correctMeaningId === cardMeaningId) {
                    const matchedWord = document.querySelector(`.word-card[data-id="${selectedWordId}"]`);
                    if (matchedWord) {
                        // æ·»åŠ æ¶ˆå¤±ç±»
                        matchedWord.classList.add('fade-out');
                        this.classList.add('fade-out');
                        
                        // ç­‰å¾…åŠ¨ç”»å®Œæˆåç§»é™¤å…ƒç´ ï¼Œä½¿ä¸‹æ–¹å¡ç‰‡ä¸Šç§»
                        setTimeout(() => {
                            matchedWord.remove();
                            this.remove();
                            matchedPairs++;
                            
                            // å…¨éƒ¨åŒ¹é…æˆåŠŸ
                            if (matchedPairs === 7) {
                                clearInterval(timerInterval);
                                backgroundMusic.volume = 0.3;
                                successText.textContent = `æ­å–œï¼ä½ å·²è¿˜åŸåˆºç§¦äº‹ä»¶å…¨è²Œï¼æ€»ç”¨æ—¶ï¼š${timerEl.textContent}`;
                                successModal.style.display = 'flex';
                            }
                        }, 500); // ä¸CSSè¿‡æ¸¡æ—¶é—´ä¸€è‡´
                    }
                    selectedWordId = null;
                } else {
                    // æ˜¾ç¤ºè‡ªå®šä¹‰é”™è¯¯æç¤ºè€Œéæµè§ˆå™¨é»˜è®¤alert
                    showErrorToast();
                    wordCards.forEach(c => c.classList.remove('selected'));
                    selectedWordId = null;
                }
            });
        });
    }

    function updateTimer() { 
        const diff = Math.floor((new Date() - startTime) / 1000); 
        timerEl.textContent = `${String(Math.floor(diff / 60)).padStart(2, '0')}:${String(diff % 60).padStart(2, '0')}`; 
    }
    
    function startGame() { 
        matchedPairs = 0; 
        selectedWordId = null; 
        startTime = new Date(); 
        clearInterval(timerInterval); 
        timerInterval = setInterval(updateTimer, 1000); 
        updateTimer(); 
        startScreen.style.display = 'none'; 
        gameContainer.style.display = 'block'; 
        renderGameCards(); 
        
        // å°è¯•æ’­æ”¾éŸ³ä¹
        backgroundMusic.play().then(() => {
            isMusicPlaying = true;
            musicControl.textContent = "â¸";
            musicHint.style.display = 'none';
        }).catch(e => {
            console.log("è‡ªåŠ¨æ’­æ”¾éœ€è¦ç”¨æˆ·äº¤äº’:", e);
            isMusicPlaying = false;
            musicControl.textContent = "â–¶";
            musicHint.style.display = 'block';
        });
    }
    
    function resetGame() { 
        successModal.style.display = 'none'; 
        backgroundMusic.volume = 1;
        startGame(); 
    }

    /* éŸ³ä¹æŒ‰é’®æ§åˆ¶ */
    musicControl.addEventListener('click', () => {
        if (isMusicPlaying) { 
            backgroundMusic.pause(); 
            isMusicPlaying = false; 
            musicControl.textContent = 'â–¶'; 
        } else { 
            backgroundMusic.play().then(() => { 
                isMusicPlaying = true; 
                musicControl.textContent = 'â¸'; 
                musicHint.style.display = 'none'; 
            }).catch(e => {
                console.log("æ’­æ”¾å¤±è´¥:", e);
                musicHint.style.display = 'block';
            }); 
        }
    });

    // ç›‘å¬éŸ³ä¹æ’­æ”¾çŠ¶æ€
    backgroundMusic.addEventListener('play', function() {
        isMusicPlaying = true;
        musicControl.textContent = "â¸";
    });
    
    backgroundMusic.addEventListener('pause', function() {
        isMusicPlaying = false;
        musicControl.textContent = "â–¶";
    });

    startBtn.addEventListener('click', startGame);
    restartBtn.addEventListener('click', resetGame);
});
</script>
</body>
</html>
    